# https://github.com/pawelmalak/flame
---
version: '3.9'
services:
  flame:
    image: pawelmalak/flame:latest
    container_name: flame
    volumes:
      - flamedata:/app/data
      - /var/run/docker.sock:/var/run/docker.sock # optional but required for Docker integration
    ports:
      - 5005:5005
    # secrets:
    #   - password # optional but required for (1)
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Kuala_Lumpur
      - PASSWORD=${PASS}
      # - PASSWORD_FILE=/run/secrets/password # optional but required for (1)
    restart: unless-stopped
    labels:
      - com.centurylinklabs.watchtower.enable=true
      # traefik
      - "traefik.enable=true"
      ## HTTP Routers
      - "traefik.http.routers.flame-rtr.entrypoints=https"
      - "traefik.http.routers.flame-rtr.rule=Host(`flame.$DOMAINNAME_CLOUD_SERVER`,`$DOMAINNAME_CLOUD_SERVER`,`www.$DOMAINNAME_CLOUD_SERVER`)"
      - "traefik.http.routers.flame-rtr.tls=true"
      ## Middlewares
      # - "traefik.http.routers.flame-rtr.middlewares=chain-basic-auth@file"
      # - "traefik.http.routers.flame-rtr.middlewares=chain-no-auth@file"
      ## HTTP Services
      - "traefik.http.routers.flame-rtr.service=flame-svc"
      - "traefik.http.services.flame-svc.loadbalancer.server.port=5005"
# # optional but required for Docker secrets (1)
# secrets:
#   password:
#     file: /path/to/secrets/password
networks:
  default:
    external: true
    name: main_network
volumes:
  flamedata:
    external: true